[{"line":"1","token_name":"T_OPEN_TAG","text":"<?php\n"},{"line":"2","token_name":"T_DECLARE","text":"declare"},{"line":"2","token_name":"(","text":"("},{"line":"2","token_name":"T_STRING","text":"strict_types"},{"line":"2","token_name":"=","text":"="},{"line":"2","token_name":"T_LNUMBER","text":"1"},{"line":"2","token_name":")","text":")"},{"line":"2","token_name":";","text":";"},{"line":"2","token_name":"T_WHITESPACE","text":"\n"},{"line":"3","token_name":"T_COMMENT","text":"\/\/ необходимые HTTP-заголовки"},{"line":"3","token_name":"T_WHITESPACE","text":"\n"},{"line":"4","token_name":"T_STRING","text":"header"},{"line":"4","token_name":"(","text":"("},{"line":"4","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"Access-Control-Allow-Origin: *\""},{"line":"4","token_name":")","text":")"},{"line":"4","token_name":";","text":";"},{"line":"4","token_name":"T_WHITESPACE","text":"\n"},{"line":"5","token_name":"T_STRING","text":"header"},{"line":"5","token_name":"(","text":"("},{"line":"5","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"Content-Type: application\/json; charset=UTF-8\""},{"line":"5","token_name":")","text":")"},{"line":"5","token_name":";","text":";"},{"line":"5","token_name":"T_WHITESPACE","text":"\n"},{"line":"6","token_name":"T_IF","text":"if"},{"line":"6","token_name":"T_WHITESPACE","text":" "},{"line":"6","token_name":"(","text":"("},{"line":"6","token_name":"T_VARIABLE","text":"$_SERVER"},{"line":"6","token_name":"[","text":"["},{"line":"6","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"REQUEST_METHOD\""},{"line":"6","token_name":"]","text":"]"},{"line":"6","token_name":"T_WHITESPACE","text":" "},{"line":"6","token_name":"T_IS_NOT_IDENTICAL","text":"!=="},{"line":"6","token_name":"T_WHITESPACE","text":" "},{"line":"6","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'GET'"},{"line":"6","token_name":")","text":")"},{"line":"6","token_name":"T_WHITESPACE","text":" "},{"line":"6","token_name":"{","text":"{"},{"line":"6","token_name":"T_WHITESPACE","text":"\n    "},{"line":"7","token_name":"T_STRING","text":"header"},{"line":"7","token_name":"(","text":"("},{"line":"7","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'HTTP\/1.0 403 Forbidden'"},{"line":"7","token_name":")","text":")"},{"line":"7","token_name":";","text":";"},{"line":"7","token_name":"T_WHITESPACE","text":"\n    "},{"line":"8","token_name":"T_STRING","text":"http_response_code"},{"line":"8","token_name":"(","text":"("},{"line":"8","token_name":"T_LNUMBER","text":"403"},{"line":"8","token_name":")","text":")"},{"line":"8","token_name":";","text":";"},{"line":"8","token_name":"T_WHITESPACE","text":"\n    "},{"line":"9","token_name":"T_ECHO","text":"echo"},{"line":"9","token_name":"T_WHITESPACE","text":" "},{"line":"9","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'This method is not allowed!'"},{"line":"9","token_name":";","text":";"},{"line":"9","token_name":"T_WHITESPACE","text":"\n    "},{"line":"10","token_name":"T_EXIT","text":"exit"},{"line":"10","token_name":";","text":";"},{"line":"10","token_name":"T_WHITESPACE","text":"\n"},{"line":"11","token_name":"}","text":"}"},{"line":"11","token_name":"T_WHITESPACE","text":"\n"},{"line":"12","token_name":"T_INCLUDE_ONCE","text":"include_once"},{"line":"12","token_name":"T_WHITESPACE","text":" "},{"line":"12","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'..\/config\/database.php'"},{"line":"12","token_name":";","text":";"},{"line":"12","token_name":"T_WHITESPACE","text":"\n"},{"line":"13","token_name":"T_INCLUDE_ONCE","text":"include_once"},{"line":"13","token_name":"T_WHITESPACE","text":" "},{"line":"13","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'..\/objects\/product.php'"},{"line":"13","token_name":";","text":";"},{"line":"13","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"15","token_name":"T_COMMENT","text":"\/\/ получаем соединение с базой данных"},{"line":"15","token_name":"T_WHITESPACE","text":"\n"},{"line":"16","token_name":"T_VARIABLE","text":"$database"},{"line":"16","token_name":"T_WHITESPACE","text":" "},{"line":"16","token_name":"=","text":"="},{"line":"16","token_name":"T_WHITESPACE","text":" "},{"line":"16","token_name":"T_NEW","text":"new"},{"line":"16","token_name":"T_WHITESPACE","text":" "},{"line":"16","token_name":"T_STRING","text":"Database"},{"line":"16","token_name":"(","text":"("},{"line":"16","token_name":")","text":")"},{"line":"16","token_name":";","text":";"},{"line":"16","token_name":"T_WHITESPACE","text":"\n"},{"line":"17","token_name":"T_VARIABLE","text":"$db"},{"line":"17","token_name":"T_WHITESPACE","text":" "},{"line":"17","token_name":"=","text":"="},{"line":"17","token_name":"T_WHITESPACE","text":" "},{"line":"17","token_name":"T_VARIABLE","text":"$database"},{"line":"17","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"17","token_name":"T_STRING","text":"getConnection"},{"line":"17","token_name":"(","text":"("},{"line":"17","token_name":")","text":")"},{"line":"17","token_name":";","text":";"},{"line":"17","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"19","token_name":"T_COMMENT","text":"\/\/ инициализируем объект"},{"line":"19","token_name":"T_WHITESPACE","text":"\n"},{"line":"20","token_name":"T_VARIABLE","text":"$product"},{"line":"20","token_name":"T_WHITESPACE","text":" "},{"line":"20","token_name":"=","text":"="},{"line":"20","token_name":"T_WHITESPACE","text":" "},{"line":"20","token_name":"T_NEW","text":"new"},{"line":"20","token_name":"T_WHITESPACE","text":" "},{"line":"20","token_name":"T_STRING","text":"Product"},{"line":"20","token_name":"(","text":"("},{"line":"20","token_name":"T_VARIABLE","text":"$db"},{"line":"20","token_name":")","text":")"},{"line":"20","token_name":";","text":";"},{"line":"20","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"22","token_name":"T_VARIABLE","text":"$stmt"},{"line":"22","token_name":"T_WHITESPACE","text":" "},{"line":"22","token_name":"=","text":"="},{"line":"22","token_name":"T_WHITESPACE","text":" "},{"line":"22","token_name":"T_VARIABLE","text":"$product"},{"line":"22","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"22","token_name":"T_STRING","text":"read"},{"line":"22","token_name":"(","text":"("},{"line":"22","token_name":")","text":")"},{"line":"22","token_name":";","text":";"},{"line":"22","token_name":"T_WHITESPACE","text":"\n"},{"line":"23","token_name":"T_VARIABLE","text":"$num"},{"line":"23","token_name":"T_WHITESPACE","text":" "},{"line":"23","token_name":"=","text":"="},{"line":"23","token_name":"T_WHITESPACE","text":" "},{"line":"23","token_name":"T_VARIABLE","text":"$stmt"},{"line":"23","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"23","token_name":"T_STRING","text":"rowCount"},{"line":"23","token_name":"(","text":"("},{"line":"23","token_name":")","text":")"},{"line":"23","token_name":";","text":";"},{"line":"23","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"25","token_name":"T_COMMENT","text":"\/\/ проверка, найдено ли больше 0 записей"},{"line":"25","token_name":"T_WHITESPACE","text":"\n"},{"line":"26","token_name":"T_IF","text":"if"},{"line":"26","token_name":"T_WHITESPACE","text":" "},{"line":"26","token_name":"(","text":"("},{"line":"26","token_name":"T_VARIABLE","text":"$num"},{"line":"26","token_name":">","text":">"},{"line":"26","token_name":"T_LNUMBER","text":"0"},{"line":"26","token_name":")","text":")"},{"line":"26","token_name":"T_WHITESPACE","text":" "},{"line":"26","token_name":"{","text":"{"},{"line":"26","token_name":"T_WHITESPACE","text":"\n\n    "},{"line":"28","token_name":"T_COMMENT","text":"\/\/ массив товаров"},{"line":"28","token_name":"T_WHITESPACE","text":"\n    "},{"line":"29","token_name":"T_VARIABLE","text":"$products_arr"},{"line":"29","token_name":"=","text":"="},{"line":"29","token_name":"T_ARRAY","text":"array"},{"line":"29","token_name":"(","text":"("},{"line":"29","token_name":")","text":")"},{"line":"29","token_name":";","text":";"},{"line":"29","token_name":"T_WHITESPACE","text":"\n\n    "},{"line":"31","token_name":"T_COMMENT","text":"\/\/ получаем содержимое нашей таблицы"},{"line":"31","token_name":"T_WHITESPACE","text":"\n    "},{"line":"32","token_name":"T_COMMENT","text":"\/\/ fetch() быстрее, чем fetchAll()"},{"line":"32","token_name":"T_WHITESPACE","text":"\n    "},{"line":"33","token_name":"T_WHILE","text":"while"},{"line":"33","token_name":"T_WHITESPACE","text":" "},{"line":"33","token_name":"(","text":"("},{"line":"33","token_name":"T_VARIABLE","text":"$row"},{"line":"33","token_name":"T_WHITESPACE","text":" "},{"line":"33","token_name":"=","text":"="},{"line":"33","token_name":"T_WHITESPACE","text":" "},{"line":"33","token_name":"T_VARIABLE","text":"$stmt"},{"line":"33","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"33","token_name":"T_STRING","text":"fetch"},{"line":"33","token_name":"(","text":"("},{"line":"33","token_name":"T_STRING","text":"PDO"},{"line":"33","token_name":"T_DOUBLE_COLON","text":"::"},{"line":"33","token_name":"T_STRING","text":"FETCH_ASSOC"},{"line":"33","token_name":")","text":")"},{"line":"33","token_name":")","text":")"},{"line":"33","token_name":"{","text":"{"},{"line":"33","token_name":"T_WHITESPACE","text":"\n\n        "},{"line":"35","token_name":"T_COMMENT","text":"\/\/ извлекаем строку"},{"line":"35","token_name":"T_WHITESPACE","text":"\n        "},{"line":"36","token_name":"T_STRING","text":"extract"},{"line":"36","token_name":"(","text":"("},{"line":"36","token_name":"T_VARIABLE","text":"$row"},{"line":"36","token_name":")","text":")"},{"line":"36","token_name":";","text":";"},{"line":"36","token_name":"T_WHITESPACE","text":"\n        "},{"line":"37","token_name":"T_VARIABLE","text":"$product_item"},{"line":"37","token_name":"T_WHITESPACE","text":" "},{"line":"37","token_name":"=","text":"="},{"line":"37","token_name":"T_WHITESPACE","text":" "},{"line":"37","token_name":"T_NEW","text":"new"},{"line":"37","token_name":"T_WHITESPACE","text":" "},{"line":"37","token_name":"T_STRING","text":"Product"},{"line":"37","token_name":"(","text":"("},{"line":"37","token_name":"T_VARIABLE","text":"$db"},{"line":"37","token_name":")","text":")"},{"line":"37","token_name":";","text":";"},{"line":"37","token_name":"T_WHITESPACE","text":"\n        "},{"line":"38","token_name":"T_VARIABLE","text":"$product_item"},{"line":"38","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"38","token_name":"T_STRING","text":"id"},{"line":"38","token_name":"T_WHITESPACE","text":" "},{"line":"38","token_name":"=","text":"="},{"line":"38","token_name":"T_WHITESPACE","text":" "},{"line":"38","token_name":"T_VARIABLE","text":"$id"},{"line":"38","token_name":";","text":";"},{"line":"38","token_name":"T_WHITESPACE","text":"\n        "},{"line":"39","token_name":"T_VARIABLE","text":"$product_item"},{"line":"39","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"39","token_name":"T_STRING","text":"name"},{"line":"39","token_name":"T_WHITESPACE","text":" "},{"line":"39","token_name":"=","text":"="},{"line":"39","token_name":"T_WHITESPACE","text":" "},{"line":"39","token_name":"T_VARIABLE","text":"$name"},{"line":"39","token_name":";","text":";"},{"line":"39","token_name":"T_WHITESPACE","text":"\n        "},{"line":"40","token_name":"T_VARIABLE","text":"$product_item"},{"line":"40","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"40","token_name":"T_STRING","text":"description"},{"line":"40","token_name":"T_WHITESPACE","text":" "},{"line":"40","token_name":"=","text":"="},{"line":"40","token_name":"T_WHITESPACE","text":" "},{"line":"40","token_name":"T_VARIABLE","text":"$description"},{"line":"40","token_name":";","text":";"},{"line":"40","token_name":"T_WHITESPACE","text":"\n        "},{"line":"41","token_name":"T_VARIABLE","text":"$product_item"},{"line":"41","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"41","token_name":"T_STRING","text":"price"},{"line":"41","token_name":"T_WHITESPACE","text":" "},{"line":"41","token_name":"=","text":"="},{"line":"41","token_name":"T_WHITESPACE","text":" "},{"line":"41","token_name":"T_STRING","text":"intval"},{"line":"41","token_name":"(","text":"("},{"line":"41","token_name":"T_VARIABLE","text":"$price"},{"line":"41","token_name":")","text":")"},{"line":"41","token_name":";","text":";"},{"line":"41","token_name":"T_WHITESPACE","text":"\n        "},{"line":"42","token_name":"T_VARIABLE","text":"$product_item"},{"line":"42","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"42","token_name":"T_STRING","text":"category_id"},{"line":"42","token_name":"T_WHITESPACE","text":" "},{"line":"42","token_name":"=","text":"="},{"line":"42","token_name":"T_WHITESPACE","text":" "},{"line":"42","token_name":"T_VARIABLE","text":"$category_id"},{"line":"42","token_name":";","text":";"},{"line":"42","token_name":"T_WHITESPACE","text":"\n        "},{"line":"43","token_name":"T_VARIABLE","text":"$product_item"},{"line":"43","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"43","token_name":"T_STRING","text":"category_name"},{"line":"43","token_name":"T_WHITESPACE","text":" "},{"line":"43","token_name":"=","text":"="},{"line":"43","token_name":"T_WHITESPACE","text":" "},{"line":"43","token_name":"T_VARIABLE","text":"$category_name"},{"line":"43","token_name":";","text":";"},{"line":"43","token_name":"T_WHITESPACE","text":"\n        "},{"line":"44","token_name":"T_VARIABLE","text":"$products_arr"},{"line":"44","token_name":"[","text":"["},{"line":"44","token_name":"]","text":"]"},{"line":"44","token_name":"T_WHITESPACE","text":" "},{"line":"44","token_name":"=","text":"="},{"line":"44","token_name":"T_WHITESPACE","text":" "},{"line":"44","token_name":"T_VARIABLE","text":"$product_item"},{"line":"44","token_name":";","text":";"},{"line":"44","token_name":"T_WHITESPACE","text":"\n    "},{"line":"45","token_name":"}","text":"}"},{"line":"45","token_name":"T_WHITESPACE","text":"\n\n    "},{"line":"47","token_name":"T_COMMENT","text":"\/\/ устанавливаем код ответа - 200 OK"},{"line":"47","token_name":"T_WHITESPACE","text":"\n    "},{"line":"48","token_name":"T_STRING","text":"http_response_code"},{"line":"48","token_name":"(","text":"("},{"line":"48","token_name":"T_LNUMBER","text":"200"},{"line":"48","token_name":")","text":")"},{"line":"48","token_name":";","text":";"},{"line":"48","token_name":"T_WHITESPACE","text":"\n\n    "},{"line":"50","token_name":"T_COMMENT","text":"\/\/ выводим данные о товаре в формате JSON"},{"line":"50","token_name":"T_WHITESPACE","text":"\n    "},{"line":"51","token_name":"T_ECHO","text":"echo"},{"line":"51","token_name":"T_WHITESPACE","text":" "},{"line":"51","token_name":"T_STRING","text":"json_encode"},{"line":"51","token_name":"(","text":"("},{"line":"51","token_name":"T_VARIABLE","text":"$products_arr"},{"line":"51","token_name":")","text":")"},{"line":"51","token_name":";","text":";"},{"line":"51","token_name":"T_WHITESPACE","text":"\n"},{"line":"52","token_name":"}","text":"}"},{"line":"52","token_name":"T_WHITESPACE","text":"\n"},{"line":"53","token_name":"T_ELSE","text":"else"},{"line":"53","token_name":"T_WHITESPACE","text":" "},{"line":"53","token_name":"{","text":"{"},{"line":"53","token_name":"T_WHITESPACE","text":"\n\n    "},{"line":"55","token_name":"T_COMMENT","text":"\/\/ установим код ответа - 404 Не найдено"},{"line":"55","token_name":"T_WHITESPACE","text":"\n    "},{"line":"56","token_name":"T_STRING","text":"http_response_code"},{"line":"56","token_name":"(","text":"("},{"line":"56","token_name":"T_LNUMBER","text":"404"},{"line":"56","token_name":")","text":")"},{"line":"56","token_name":";","text":";"},{"line":"56","token_name":"T_WHITESPACE","text":"\n\n    "},{"line":"58","token_name":"T_COMMENT","text":"\/\/ сообщаем пользователю, что товары не найдены"},{"line":"58","token_name":"T_WHITESPACE","text":"\n    "},{"line":"59","token_name":"T_ECHO","text":"echo"},{"line":"59","token_name":"T_WHITESPACE","text":" "},{"line":"59","token_name":"T_STRING","text":"json_encode"},{"line":"59","token_name":"(","text":"("},{"line":"59","token_name":"T_ARRAY","text":"array"},{"line":"59","token_name":"(","text":"("},{"line":"59","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"message\""},{"line":"59","token_name":"T_WHITESPACE","text":" "},{"line":"59","token_name":"T_DOUBLE_ARROW","text":"=>"},{"line":"59","token_name":"T_WHITESPACE","text":" "},{"line":"59","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"Товары не найдены.\""},{"line":"59","token_name":")","text":")"},{"line":"59","token_name":",","text":","},{"line":"59","token_name":"T_WHITESPACE","text":" "},{"line":"59","token_name":"T_STRING","text":"JSON_UNESCAPED_UNICODE"},{"line":"59","token_name":")","text":")"},{"line":"59","token_name":";","text":";"},{"line":"59","token_name":"T_WHITESPACE","text":"\n"},{"line":"60","token_name":"}","text":"}"}]