[{"line":"1","token_name":"T_OPEN_TAG","text":"<?php\n"},{"line":"2","token_name":"T_DECLARE","text":"declare"},{"line":"2","token_name":"(","text":"("},{"line":"2","token_name":"T_STRING","text":"strict_types"},{"line":"2","token_name":"=","text":"="},{"line":"2","token_name":"T_LNUMBER","text":"1"},{"line":"2","token_name":")","text":")"},{"line":"2","token_name":";","text":";"},{"line":"2","token_name":"T_WHITESPACE","text":"\n"},{"line":"3","token_name":"T_COMMENT","text":"\/\/ необходимые HTTP-заголовки"},{"line":"3","token_name":"T_WHITESPACE","text":"\n"},{"line":"4","token_name":"T_STRING","text":"header"},{"line":"4","token_name":"(","text":"("},{"line":"4","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"Access-Control-Allow-Origin: *\""},{"line":"4","token_name":")","text":")"},{"line":"4","token_name":";","text":";"},{"line":"4","token_name":"T_WHITESPACE","text":"\n"},{"line":"5","token_name":"T_STRING","text":"header"},{"line":"5","token_name":"(","text":"("},{"line":"5","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"Access-Control-Allow-Headers: access\""},{"line":"5","token_name":")","text":")"},{"line":"5","token_name":";","text":";"},{"line":"5","token_name":"T_WHITESPACE","text":"\n"},{"line":"6","token_name":"T_STRING","text":"header"},{"line":"6","token_name":"(","text":"("},{"line":"6","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"Access-Control-Allow-Methods: GET\""},{"line":"6","token_name":")","text":")"},{"line":"6","token_name":";","text":";"},{"line":"6","token_name":"T_WHITESPACE","text":"\n"},{"line":"7","token_name":"T_STRING","text":"header"},{"line":"7","token_name":"(","text":"("},{"line":"7","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"Access-Control-Allow-Credentials: true\""},{"line":"7","token_name":")","text":")"},{"line":"7","token_name":";","text":";"},{"line":"7","token_name":"T_WHITESPACE","text":"\n"},{"line":"8","token_name":"T_STRING","text":"header"},{"line":"8","token_name":"(","text":"("},{"line":"8","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"Content-Type: application\/json\""},{"line":"8","token_name":")","text":")"},{"line":"8","token_name":";","text":";"},{"line":"8","token_name":"T_WHITESPACE","text":"\n"},{"line":"9","token_name":"T_IF","text":"if"},{"line":"9","token_name":"T_WHITESPACE","text":" "},{"line":"9","token_name":"(","text":"("},{"line":"9","token_name":"T_VARIABLE","text":"$_SERVER"},{"line":"9","token_name":"[","text":"["},{"line":"9","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"REQUEST_METHOD\""},{"line":"9","token_name":"]","text":"]"},{"line":"9","token_name":"T_WHITESPACE","text":" "},{"line":"9","token_name":"T_IS_NOT_IDENTICAL","text":"!=="},{"line":"9","token_name":"T_WHITESPACE","text":" "},{"line":"9","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'GET'"},{"line":"9","token_name":")","text":")"},{"line":"9","token_name":"T_WHITESPACE","text":" "},{"line":"9","token_name":"{","text":"{"},{"line":"9","token_name":"T_WHITESPACE","text":"\n    "},{"line":"10","token_name":"T_STRING","text":"header"},{"line":"10","token_name":"(","text":"("},{"line":"10","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'HTTP\/1.0 403 Forbidden'"},{"line":"10","token_name":")","text":")"},{"line":"10","token_name":";","text":";"},{"line":"10","token_name":"T_WHITESPACE","text":"\n    "},{"line":"11","token_name":"T_STRING","text":"http_response_code"},{"line":"11","token_name":"(","text":"("},{"line":"11","token_name":"T_LNUMBER","text":"403"},{"line":"11","token_name":")","text":")"},{"line":"11","token_name":";","text":";"},{"line":"11","token_name":"T_WHITESPACE","text":"\n    "},{"line":"12","token_name":"T_ECHO","text":"echo"},{"line":"12","token_name":"T_WHITESPACE","text":" "},{"line":"12","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'This method is not allowed!'"},{"line":"12","token_name":";","text":";"},{"line":"12","token_name":"T_WHITESPACE","text":"\n    "},{"line":"13","token_name":"T_EXIT","text":"exit"},{"line":"13","token_name":";","text":";"},{"line":"13","token_name":"T_WHITESPACE","text":"\n"},{"line":"14","token_name":"}","text":"}"},{"line":"14","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"16","token_name":"T_COMMENT","text":"\/\/ подключение файла для соединения с базой и файл с объектом"},{"line":"16","token_name":"T_WHITESPACE","text":"\n"},{"line":"17","token_name":"T_INCLUDE_ONCE","text":"include_once"},{"line":"17","token_name":"T_WHITESPACE","text":" "},{"line":"17","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'..\/config\/database.php'"},{"line":"17","token_name":";","text":";"},{"line":"17","token_name":"T_WHITESPACE","text":"\n"},{"line":"18","token_name":"T_INCLUDE_ONCE","text":"include_once"},{"line":"18","token_name":"T_WHITESPACE","text":" "},{"line":"18","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'..\/objects\/product.php'"},{"line":"18","token_name":";","text":";"},{"line":"18","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"20","token_name":"T_COMMENT","text":"\/\/ получаем соединение с базой данных"},{"line":"20","token_name":"T_WHITESPACE","text":"\n"},{"line":"21","token_name":"T_VARIABLE","text":"$database"},{"line":"21","token_name":"T_WHITESPACE","text":" "},{"line":"21","token_name":"=","text":"="},{"line":"21","token_name":"T_WHITESPACE","text":" "},{"line":"21","token_name":"T_NEW","text":"new"},{"line":"21","token_name":"T_WHITESPACE","text":" "},{"line":"21","token_name":"T_STRING","text":"Database"},{"line":"21","token_name":"(","text":"("},{"line":"21","token_name":")","text":")"},{"line":"21","token_name":";","text":";"},{"line":"21","token_name":"T_WHITESPACE","text":"\n"},{"line":"22","token_name":"T_VARIABLE","text":"$db"},{"line":"22","token_name":"T_WHITESPACE","text":" "},{"line":"22","token_name":"=","text":"="},{"line":"22","token_name":"T_WHITESPACE","text":" "},{"line":"22","token_name":"T_VARIABLE","text":"$database"},{"line":"22","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"22","token_name":"T_STRING","text":"getConnection"},{"line":"22","token_name":"(","text":"("},{"line":"22","token_name":")","text":")"},{"line":"22","token_name":";","text":";"},{"line":"22","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"24","token_name":"T_COMMENT","text":"\/\/ подготовка объекта"},{"line":"24","token_name":"T_WHITESPACE","text":"\n"},{"line":"25","token_name":"T_VARIABLE","text":"$product"},{"line":"25","token_name":"T_WHITESPACE","text":" "},{"line":"25","token_name":"=","text":"="},{"line":"25","token_name":"T_WHITESPACE","text":" "},{"line":"25","token_name":"T_NEW","text":"new"},{"line":"25","token_name":"T_WHITESPACE","text":" "},{"line":"25","token_name":"T_STRING","text":"Product"},{"line":"25","token_name":"(","text":"("},{"line":"25","token_name":"T_VARIABLE","text":"$db"},{"line":"25","token_name":")","text":")"},{"line":"25","token_name":";","text":";"},{"line":"25","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"27","token_name":"T_COMMENT","text":"\/\/ установим свойство ID записи для чтения"},{"line":"27","token_name":"T_WHITESPACE","text":"\n"},{"line":"28","token_name":"T_VARIABLE","text":"$id"},{"line":"28","token_name":"T_WHITESPACE","text":" "},{"line":"28","token_name":"=","text":"="},{"line":"28","token_name":"T_WHITESPACE","text":" "},{"line":"28","token_name":"T_STRING","text":"intval"},{"line":"28","token_name":"(","text":"("},{"line":"28","token_name":"T_VARIABLE","text":"$_GET"},{"line":"28","token_name":"[","text":"["},{"line":"28","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"'id'"},{"line":"28","token_name":"]","text":"]"},{"line":"28","token_name":")","text":")"},{"line":"28","token_name":"T_WHITESPACE","text":" "},{"line":"28","token_name":"T_COALESCE","text":"??"},{"line":"28","token_name":"T_WHITESPACE","text":" "},{"line":"28","token_name":"T_EXIT","text":"die"},{"line":"28","token_name":"(","text":"("},{"line":"28","token_name":")","text":")"},{"line":"28","token_name":";","text":";"},{"line":"28","token_name":"T_WHITESPACE","text":"\n"},{"line":"29","token_name":"T_VARIABLE","text":"$product"},{"line":"29","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"29","token_name":"T_STRING","text":"id"},{"line":"29","token_name":"T_WHITESPACE","text":" "},{"line":"29","token_name":"=","text":"="},{"line":"29","token_name":"T_WHITESPACE","text":" "},{"line":"29","token_name":"T_VARIABLE","text":"$id"},{"line":"29","token_name":";","text":";"},{"line":"29","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"31","token_name":"T_COMMENT","text":"\/\/ прочитаем детали товара для редактирования"},{"line":"31","token_name":"T_WHITESPACE","text":"\n"},{"line":"32","token_name":"T_VARIABLE","text":"$product"},{"line":"32","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"32","token_name":"T_STRING","text":"readOne"},{"line":"32","token_name":"(","text":"("},{"line":"32","token_name":")","text":")"},{"line":"32","token_name":";","text":";"},{"line":"32","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"34","token_name":"T_IF","text":"if"},{"line":"34","token_name":"T_WHITESPACE","text":" "},{"line":"34","token_name":"(","text":"("},{"line":"34","token_name":"T_VARIABLE","text":"$product"},{"line":"34","token_name":"T_OBJECT_OPERATOR","text":"->"},{"line":"34","token_name":"T_STRING","text":"name"},{"line":"34","token_name":"T_IS_NOT_EQUAL","text":"!="},{"line":"34","token_name":"T_STRING","text":"null"},{"line":"34","token_name":")","text":")"},{"line":"34","token_name":"T_WHITESPACE","text":" "},{"line":"34","token_name":"{","text":"{"},{"line":"34","token_name":"T_WHITESPACE","text":"\n    "},{"line":"35","token_name":"T_STRING","text":"http_response_code"},{"line":"35","token_name":"(","text":"("},{"line":"35","token_name":"T_LNUMBER","text":"200"},{"line":"35","token_name":")","text":")"},{"line":"35","token_name":";","text":";"},{"line":"35","token_name":"T_WHITESPACE","text":"\n    "},{"line":"36","token_name":"T_ECHO","text":"echo"},{"line":"36","token_name":"T_WHITESPACE","text":" "},{"line":"36","token_name":"T_STRING","text":"json_encode"},{"line":"36","token_name":"(","text":"("},{"line":"36","token_name":"T_VARIABLE","text":"$product"},{"line":"36","token_name":")","text":")"},{"line":"36","token_name":";","text":";"},{"line":"36","token_name":"T_WHITESPACE","text":"\n"},{"line":"37","token_name":"}","text":"}"},{"line":"37","token_name":"T_WHITESPACE","text":"\n\n"},{"line":"39","token_name":"T_ELSE","text":"else"},{"line":"39","token_name":"T_WHITESPACE","text":" "},{"line":"39","token_name":"{","text":"{"},{"line":"39","token_name":"T_WHITESPACE","text":"\n    "},{"line":"40","token_name":"T_COMMENT","text":"\/\/ код ответа - 404 Не найдено"},{"line":"40","token_name":"T_WHITESPACE","text":"\n    "},{"line":"41","token_name":"T_STRING","text":"http_response_code"},{"line":"41","token_name":"(","text":"("},{"line":"41","token_name":"T_LNUMBER","text":"404"},{"line":"41","token_name":")","text":")"},{"line":"41","token_name":";","text":";"},{"line":"41","token_name":"T_WHITESPACE","text":"\n\n    "},{"line":"43","token_name":"T_COMMENT","text":"\/\/ сообщим пользователю, что товар не существует"},{"line":"43","token_name":"T_WHITESPACE","text":"\n    "},{"line":"44","token_name":"T_ECHO","text":"echo"},{"line":"44","token_name":"T_WHITESPACE","text":" "},{"line":"44","token_name":"T_STRING","text":"json_encode"},{"line":"44","token_name":"(","text":"("},{"line":"44","token_name":"T_ARRAY","text":"array"},{"line":"44","token_name":"(","text":"("},{"line":"44","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"message\""},{"line":"44","token_name":"T_WHITESPACE","text":" "},{"line":"44","token_name":"T_DOUBLE_ARROW","text":"=>"},{"line":"44","token_name":"T_WHITESPACE","text":" "},{"line":"44","token_name":"T_CONSTANT_ENCAPSED_STRING","text":"\"Товар не существует.\""},{"line":"44","token_name":")","text":")"},{"line":"44","token_name":",","text":","},{"line":"44","token_name":"T_WHITESPACE","text":" "},{"line":"44","token_name":"T_STRING","text":"JSON_UNESCAPED_UNICODE"},{"line":"44","token_name":")","text":")"},{"line":"44","token_name":";","text":";"},{"line":"44","token_name":"T_WHITESPACE","text":"\n"},{"line":"45","token_name":"}","text":"}"},{"line":"45","token_name":"T_WHITESPACE","text":"\n"}]